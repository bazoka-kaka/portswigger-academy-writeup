# Lab Writeup: Exploiting server-side parameter pollution in a query string

URL: https://portswigger.net/web-security/learning-paths/api-testing/api-testing-testing-for-server-side-parameter-pollution-in-the-query-string/api-testing/server-side-parameter-pollution/lab-exploiting-server-side-parameter-pollution-in-query-string

## Description

To solve the lab, log in as the `administrator` and delete `carlos`.

## Solution

1. Go to `/login` then click on **forgot password** then enter `administrator` as username then submit while intercepting it. Below is the intercepted request:

   ![api-param-pollution](/assets/api-param-pollution.png)

2. Send the above request to repeater then add `%23` which means **#** to the body as below:

   ![api-param-pollution-1](/assets/api-param-pollution-1.png)

   From the above response, we could see "Field not specified" error

3. Change the body again, add `%26` which means **&**, the full payload would be `%26field=test%23`. Following is the request and response:

   ![api-param-pollution-2](/assets/api-param-pollution-2.png)

   From the above we could try using burp intruder, then we find that `email` value is the correct one:

   ![api-param-pollution-3](/assets/api-param-pollution-3.png)

4. Check `/static/js/forgotPassword.js`:

   ![api-param-pollution-5](/assets/api-param-pollution-5.png)

5. From the above response we could see `reset_token` field, we can try the payload `%26field=reset_token%23`:

   ![api-param-pollution-6](/assets/api-param-pollution-6.png)

6. Go back to the browser with the path `/forgot-password?reset_token=eerrpyul8kafmd58bx31a6tgq6rtupnt` then change the password to for example **test**, submit

7. Login with `administrator:test`, go to `/admin`, delete `carlos` and the lab should be solved.

   ![api-param-pollution-7](/assets/api-param-pollution-7.png)
