# Lab Writeup: Exploiting a mass assignment vulnerability

URL: https://portswigger.net/web-security/learning-paths/api-testing/api-testing-mass-assignment-vulnerabilities/api-testing/lab-exploiting-mass-assignment-vulnerability

## Description

To solve the lab, find and exploit a mass assignment vulnerability to buy a **Lightweight l33t Leather Jacket**. You can log in to your own account using the following credentials: `wiener:peter`.

## Solution

1.  Login using `wiener:peter`
2.  View details to **Lightweight l33t Leather Jacket** then add to cart
3.  Go to cart and intercept the request as the following:

    ![api-mass-assignment](/assets/api-mass-assignment.png)

    Send the above request to repeater

4.  Change the above request's metod to `OPTIONS`

    ![api-mass-assignment-2](/assets/api-mass-assignment-1.png)

    From the above response, we could see that we could also do `POST` request

5.  Change the request method to `POST`, add `Content-Type: application/json` also body:

    ```
     {"chosen_discount":{"percentage":100},"chosen_products":[{"product_id":"1","name":"Lightweight \"l33t\" Leather Jacket","quantity":1,"item_price":133700}]}
    ```

    note that the percentage is 100%

6.  Send and the lab should be solved

    ![api-mass-assignment-3](/assets/api-mass-assignment-2.png)

    ![api-mass-assignment-3](/assets/api-mass-assignment-3.png)
